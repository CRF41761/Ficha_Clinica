<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Ficha Clínica - CRF "La Granja"</title>
  <style>
    @page { size: A4 portrait; margin: 1.5cm; }
    body { font-family: Arial, sans-serif; background: #fff; margin: 0; padding: 0; }
    .a4-wrap {
      max-width: 185mm;
      min-height: 260mm;
      margin: 0 auto;
      box-sizing: border-box;
      padding: 0;
      display: flex;
      flex-direction: column;
      background: #fff;
    }
    /* ... (resto de tu CSS igual, sin cambios) ... */

    @media print {
      body { margin: 0; padding: 0; }
      .a4-wrap {
        box-shadow: none;
        border: none;
        margin: 0 !important;
        width: 100vw;
        min-height: 100vh;
        padding: 0;
      }
      input, textarea { border: none !important; background: none !important; color: #000 !important; }
      .campo-input, .campo-inline, .campo-inline-medio, .campo-inline-largo { border-bottom: 1.2px solid #666 !important; }
      .reg-entrada-input { border: 2px solid #333 !important; background: none !important; }
      .salida-checkbox { border: 1.3px solid #555 !important; }
      .fecha-input, .salida-fecha { display: none !important; }
      /* Ajuste para la imagen trasera: ocupa toda la página siguiente */
      .trasera-img {
        width: 100%;
        height: auto;
        max-width: 100vw;
        display: block;
        margin: 0 auto;
        page-break-before: always;
      }
    }
  </style>
</head>
<body>
  <div class="a4-wrap">
    <!-- ... Tu HTML de la ficha clínica igual ... -->
    <!-- REG. ENTRADA + DATOS EN CAJA -->
    <!-- ... resto ... -->
    <!-- SALIDA -->
    <!-- ... resto ... -->
  </div>
  <!-- SCRIPT DE AUTOCOMPLETADO POR URL -->
  <script>
    function getParams() {
      const params = {};
      const query = window.location.search.substring(1);
      for (const pair of query.split("&")) {
        if (!pair) continue;
        const [k, v] = pair.split("=");
        params[decodeURIComponent(k)] = decodeURIComponent(v || "");
      }
      return params;
    }

    function fillForm() {
      const params = getParams();
      // Mapeo correcto y explícito: nombre parámetro URL -> name input HTML
      const map = {
        "numero_de_entrada": "reg_entrada",
        "fecha_entrada_manual": "fecha_entrada_manual",
        "especie_nombre_cientifico": "especie",
        "municipio": "municipio",
        "coordenadas_del_mapa": "coord_utm",
        "apoyo": "apoyo_elec",
        "km_ctra": "km_ctra",
        "causa_entrada": "causa_entrada",
        "remitente": "remitente",
        "observaciones": "observaciones"
      };
      for (const key in map) {
        const paramValue = params[key] || "";
        const htmlName = map[key];
        const el = document.querySelector(`[name="${htmlName}"]`);
        if (el) el.value = paramValue;
      }
    }
    window.onload = fillForm;
  </script>
  <!-- Hoja de seguimiento (trasera, ya girada en horizontal) -->
  <img src="Trasera_Ficha_Clinica.jpg" alt="Hoja de seguimiento - Trasera ficha clínica" class="trasera-img">
</body>
</html>
